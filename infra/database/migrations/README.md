# Database Migrations

This directory contains database migration files generated by Drizzle Kit.

## Usage

### Generate migrations from schema changes
```bash
npm run database:generate
```

This will analyze your schema files (`src/**/*.model.js`) and generate migration files in this directory.

### Apply migrations to database
```bash
npm run database:migrate
```

This will run all pending migrations against the database.

### Push schema changes directly (development only)
```bash
npm run database:push
```

⚠️ **Warning**: `database:push` directly modifies the database schema without creating migration files. Use only in development.

### Check migration status
```bash
npm run database:check
```

### Drop all tables (⚠️ destructive)
```bash
npm run database:drop
```

### Reset database (drop + push + migrate + seed)
```bash
npm run database:reset
```

## Migration Workflow

1. **Make schema changes** in your model files (`src/**/*.model.js`)
2. **Generate migrations**: `npm run database:generate`
3. **Review generated migrations** in `infra/database/migrations/`
4. **Apply migrations**: `npm run database:migrate`
5. **Run seeds** (optional): `npm run database:seed:dev`

## Best Practices

- Always review generated migrations before applying
- Never edit migration files manually (regenerate if needed)
- Use migrations in production, not `database:push`
- Keep migrations small and focused
- Test migrations on a copy of production data before applying

